<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="罗传月武">
        <link rel="canonical" href="https://learncpp-cn.github.io/8-Basic object-oriented programming/8.3-Public vs private access specifiers/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>8.3-公有私有访问修饰符 - LearnCpp中文版</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/darcula.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-82042025-2', 'learncpp-cn.github.io');
            ga('send', 'pageview');
        </script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../..">LearnCpp中文版</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../..">主页</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">目录 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">第0章-简介/入门</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../0-Introduction&Getting Started/0.1-Introduction to these tutorials/">0.1-教程简介</a>
</li>
            
<li >
    <a href="../../0-Introduction&Getting Started/0.2-Introduction to programming languages/">0.2-编程语言简介</a>
</li>
            
<li >
    <a href="../../0-Introduction&Getting Started/0.3-Introduction to C C++/">0.3-C/C++简介</a>
</li>
            
<li >
    <a href="../../0-Introduction&Getting Started/0.4-Introduction to C++ development/">0.4-C++开发简介</a>
</li>
            
<li >
    <a href="../../0-Introduction&Getting Started/0.5-Introduction to the compiler, linker, and libraries/">0.5-编译器，链接器和库简介</a>
</li>
            
<li >
    <a href="../../0-Introduction&Getting Started/0.6-Installing an Integrated Development Environment (IDE)/">0.6-安装集成开发环境(IDE)</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">第1章-C++基础知识</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../1-C++ Basics/1.1-Structure of a program/">1.1-程序的结构</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">第7章-函数</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../7-Functions/7.5-Inline functions/">7.5-内联函数</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">第8章- 面向对象编程基础</a>
    <ul class="dropdown-menu">
            
<li class="active">
    <a href="./">8.3-公有私有访问修饰符</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li >
                                <a href="../../about.md">关于中文翻译</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../../7-Functions/7.5-Inline functions/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="disabled">
                                <a rel="prev" >
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#_1">公有私有成员</a></li>
        <li class="main "><a href="#_2">访问修饰符</a></li>
        <li class="main "><a href="#_3">混合访问修饰符</a></li>
        <li class="main "><a href="#vs">结构体vs类复习</a></li>
        <li class="main "><a href="#_5">练习时间</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h3 id="_1">公有私有成员</h3>
<p>查看如下结构体：</p>
<pre><code>struct DateStruct // 结构体成员默认是公有的（public）
{
    int month; // 默认公有, 可被任何人访问
    int day; // 默认公有, 可被任何人访问
    int year; // 默认公有, 可被任何人访问
};

int main()
{
    DateStruct date;
    date.month = 10;
    date.day = 14;
    date.year= 2020;

    return 0;
}
</code></pre>

<p>在这段程序里，我们声明了一个DateStruct并直接访问它的成员来进行初始化。之所有可以这样是因为一个结构体的成员默认是公有的。<strong>公有成员</strong>是指结构体或者类中可以被外部访问的成员。因此，main函数位于DateStruct外，但我们仍可以直接访问它的成员年、月、日，因为它们是公有的。</p>
<p>另一方面，我们瞧一瞧下面这个类，它和DateStruct几乎相同。</p>
<pre><code>class DateClass // 类成员默认是私有的
{
    int m_month; // 默认私有, 只能被其他成员访问
    int m_day; // 默认私有, 只能被其他成员访问
    int m_year; // 默认私有, 只能被其他成员访问
};

int main()
{
    DateClass date;
    date.m_month = 10; // 出错
    date.m_day = 14; // 出错
    date.m_year = 2020; // 出错

    return 0;
}
</code></pre>

<p>如果你编译这段程序，会报错。这是因为默认情况下，一个类的所有成员都是私有的。<strong>私有成员</strong>是指结构体或者类中只能被该结构体或类的内部成员访问的成员。因为main函数不是DateClass的内部成员，所以它不能够访问DateClass的内部成员。</p>
<h3 id="_2">访问修饰符</h3>
<p>尽管类的成员默认是私有的，但我们可以通过public关键字让它变成公有的。</p>
<pre><code>class DateClass
{
public: // note use of public keyword here, and the colon
    int m_month; // public, can be accessed by anyone
    int m_day; // public, can be accessed by anyone
    int m_year; // public, can be accessed by anyone
};

int main()
{
    DateClass date;
    date.m_month = 10; // okay because m_month is public
    date.m_day = 14;  // okay because m_day is public
    date.m_year = 2020;  // okay because m_year is public

    return 0;
}
</code></pre>

<p>因为DateClass的成员现在是公有的，所以我们可以直接在main函数里访问了。</p>
<p>public关键字及随后的冒号就是一个访问修饰符。<strong>访问修饰符</strong>决定了谁可以访问修饰符后边的成员。每一个成员都会活得前面所指定的访问修饰符的访问级别（如果没指定的话，就是用默认访问修饰符）。</p>
<p>C++提供三种不同的访问修饰符关键字：public，private，和protected。public让被修饰的成员变得公有，private让被修饰的成员变得私有。第三个修饰符，即protected，功能跟private类似。在我们之后的章节开始学习继承的时候，我们会讨论一下private和protected修饰符到底有什么区别。</p>
<h3 id="_3">混合访问修饰符</h3>
<p>类通常使用多种访问修饰符来设置其内部成员的访问级别。在类中使用访问修饰符并没有数量上的限制。</p>
<p>通常情况下，成员变量一般设置为私有，成员函数则设置为公有。我们会在下一节告诉你为什么。</p>
<p><em>规则：除非你有什么特殊的理由，不然就让成员变量私有，让成员方法公有。</em></p>
<p>观察下面的例子，它是一个同时使用了private和public访问修饰符的类。</p>
<pre><code>#include &lt;iostream&gt;

class DateClass // members are private by default
{
    int m_month; // private by default, can only be accessed by other members
    int m_day; // private by default, can only be accessed by other members
    int m_year; // private by default, can only be accessed by other members

public:
    void setDate(int month, int day, int year) // public, can be accessed by anyone
    {
        // setDate() can access the private members of the class because it is a member of the class itself
        m_month = month;
        m_day = day;
        m_year = year;
    }

    void print() // public, can be accessed by anyone
    {
        std::cout &lt;&lt; m_month &lt;&lt; &quot;/&quot; &lt;&lt; m_day &lt;&lt; &quot;/&quot; &lt;&lt; m_year;
    }
};

int main()
{
    DateClass date;
    date.setDate(10, 14, 2020); // okay, because setDate() is public
    date.print(); // okay, because print() is public

    return 0;
}
</code></pre>

<p>这段程序输出：</p>
<p>10/14/2020</p>
<p>尽管我们不能在main函数里访问m_month、m_day、m_year（因为它们是私有的），但我们可以通过它的公有成员函数setDate()和print()对这些私有变量进行间接访问。</p>
<p>一个类的公有成员通常又被成为公共接口（public interface）。因为只有公公成员可以在类的外部被访问，公共接口定义了使用这个类的程序如何与这个类进行交互。注意上面的main函数，被严格限制只能设置日期和输出日期，DateClass保护它的成员变量不会被直接访问和编辑。</p>
<p>有些程序员喜欢把私有成员写在前面，因为公有成员一般都会使用私有成员，所以理所当然地把私有成员写在前面。然而，类的使用者并不关心私有成员，所以公有成员应该写在前面。无论哪种方式，都是可取的。</p>
<h2 id="_4"></h2>
<p>观察下面的程序：</p>
<pre><code>#include &lt;iostream&gt;

class DateClass // members are private by default
{
    int m_month; // private by default, can only be accessed by other members
    int m_day; // private by default, can only be accessed by other members
    int m_year; // private by default, can only be accessed by other members

public:
    void setDate(int month, int day, int year)
    {
        m_month = month;
        m_day = day;
        m_year = year;
    }

    void print()
    {
        std::cout &lt;&lt; m_month &lt;&lt; &quot;/&quot; &lt;&lt; m_day &lt;&lt; &quot;/&quot; &lt;&lt; m_year;
    }

    // 看这里看这里
    void copyFrom(const DateClass &amp;d)
    {
        // 注意我们可以直接访问参数d的私有成员
        m_month = d.m_month;
        m_day = d.m_day;
        m_year = d.m_year;
    }
};

int main()
{
    DateClass date;
    date.setDate(10, 14, 2020); // okay, because setDate() is public

    DateClass copy;
    copy.copyFrom(date); // okay, because copyFrom() is public
    copy.print();

    return 0;
}
</code></pre>

<p>C++一个容易被忽视且误解的特性就是，访问控制作用于每个类，而不是每个对象（One nuance of C++ that is often missed or misunderstood is that access control works on a per-class basis, not a per-object basis.）。如果一个函数可以访问一个类的私有成员，那么这个函数就可以访问该类类型的任何对象的私有成员。</p>
<p>在上面的例子，copyFrom()是DateClass的一个成员，对DateClass的私有成员拥有访问权限。这意味着，copyFrom()不仅可以访问自身实例的私有成员，还可以访问参数<strong>d</strong>的私有成员！如果参数d是其他类型，那就另当别论了。</p>
<p>在需要从一个类的对象复制数据到同一个类的另外一个对象时，这个特性会变得非常有用。就在下一章讨论重载操作符&lt;&lt;来打印一个类的成员时，这个知识点我们会再次遇到。</p>
<h2 id="vs">结构体vs类复习</h2>
<p>现在我们已经学习了访问修饰符，我们也讨论了c++当中一个类和结构体的不同之处。一个类默认它的成员都是私有的，一个结构体默认它的成员都是公有的。</p>
<p>那就完了！</p>
<p>（可是，我还想再啰嗦一下，这里还有一个细微的不同之处--结构体会公有地继承其他类，类则会私有地继承其他类。我们会在之后的章节解释它的意思，然而这一点实际上是无关紧要的，因为一般人不会使用默认继承。）</p>
<h2 id="_5">练习时间</h2>
<p>1a) 什么是公有成员?</p>
<blockquote>
<p>公有成员是一个类的成员，它能被任何人访问。</p>
</blockquote>
<p>1b) 什么是私有成员</p>
<blockquote>
<p>私有成员是一个类的成员，但只能被它所在类的其他成员访问。</p>
</blockquote>
<p>1c) 什么是访问修饰符</p>
<blockquote>
<p>访问修饰符决定谁可以访问被它修饰的成员。</p>
</blockquote>
<p>1d) 有多少个访问修饰符，他们分别是？</p>
<blockquote>
<p>三个，分别是public、private、protected。</p>
</blockquote>
<p>2a) Write a simple class named Point3d. The class should contain:
<em> Three private member variables of type double named m_x, m_y, and m_z;
</em> A public member function named setValues() that allows you to set values for m_x, m_y, and m_z.
* A public member function named print() that prints the Point in the following format: <m_x, m_y, m_z></p>
<p>Make sure the following program executes correctly:</p>
<pre><code>int main()
{
    Point3d point;
    point.setValues(1.0, 2.0, 3.0);

    point.print();

    return 0;
}
</code></pre>

<p>This should print:</p>
<p>&lt;1, 2, 3&gt;</p>
<p>答案:</p>
<pre><code>#include &lt;iostream&gt;

class Point3d
{
private:
    double m_x, m_y, m_z;

public:
    void setValues(double x, double y, double z)
    {
        m_x = x;
        m_y = y;
        m_z = z;
    }

    void print()
    {
        std::cout &lt;&lt; &quot;&lt;&quot; &lt;&lt; m_x &lt;&lt; &quot;, &quot; &lt;&lt; m_y &lt;&lt; &quot;, &quot; &lt;&lt; m_z &lt;&lt; &quot;&gt;&quot;;
    }
};

int main()
{
    Point3d point;
    point.setValues(1.0, 2.0, 3.0);

    point.print();

    return 0;
}
</code></pre>

<p>2b) Add a function named isEqual() to your Point3d class. The following code should run correctly:</p>
<pre><code>int main()
{
    Point3d point1;
    point1.setValues(1.0, 2.0, 3.0);

    Point3d point2;
    point2.setValues(1.0, 2.0, 3.0);

    if (point1.isEqual(point2))
        std::cout &lt;&lt; &quot;point1 and point2 are equal\n&quot;;
    else
        std::cout &lt;&lt; &quot;point1 and point2 are not equal\n&quot;;

    Point3d point3;
    point3.setValues(3.0, 4.0, 5.0);

    if (point1.isEqual(point3))
        std::cout &lt;&lt; &quot;point1 and point3 are equal\n&quot;;
    else
        std::cout &lt;&lt; &quot;point1 and point3 are not equal\n&quot;;

    return 0;
}
</code></pre>

<p>答案:</p>
<pre><code>#include &lt;iostream&gt;

class Point3d
{
private:
    double m_x, m_y, m_z;

public:
    void setValues(double x, double y, double z)
    {
        m_x = x;
        m_y = y;
        m_z = z;
    }

    void print()
    {
        std::cout &lt;&lt; &quot;&lt;&quot; &lt;&lt; m_x &lt;&lt; &quot;, &quot; &lt;&lt; m_y &lt;&lt; &quot;, &quot; &lt;&lt; m_z &lt;&lt; &quot;&gt;&quot;;
    }

    // We can use the fact that access controls work on a per-class basis here
    // to directly access the private members of Point3d parameter p
    bool isEqual(const Point3d &amp;p)
    {
        return (m_x == p.m_x &amp;&amp; m_y == p.m_y &amp;&amp; m_z == p.m_z);
    }
};

int main()
{
    Point3d point1;
    point1.setValues(1.0, 2.0, 3.0);

    Point3d point2;
    point2.setValues(1.0, 2.0, 3.0);

    if (point1.isEqual(point2))
        std::cout &lt;&lt; &quot;point1 and point2 are equal\n&quot;;
    else
        std::cout &lt;&lt; &quot;point1 and point2 are not equal\n&quot;;

    Point3d point3;
    point3.setValues(3.0, 4.0, 5.0);

    if (point1.isEqual(point3))
        std::cout &lt;&lt; &quot;point1 and point3 are equal\n&quot;;
    else
        std::cout &lt;&lt; &quot;point1 and point3 are not equal\n&quot;;

    return 0;
}
</code></pre>

<p>3) Now let’s try something a little more complex. Let’s write a class that implements a simple stack from scratch. Review lesson 7.9 -- The stack and the heap if you need a refresher on a what a stack is.</p>
<p>The class should be named Stack, and should contain:
<em> A private fixed array of integers of length 10.
</em> A private integer to keep track of the length of the stack.
<em> A public member function named reset() that sets the length to 0 and all of the element values to 0.
</em> A public member function named push() that pushes a value on the stack. push() should return false if the array is already full, and true otherwise.
<em> A public member function named pop() that pops a value off the stack and returns it. If there are no values on the stack, the code should exit via an assert.
</em> A public member function named print() that prints all the values in the stack.</p>
<p>Make sure the following program executes correctly:</p>
<pre><code>int main()
{
    Stack stack;
    stack.reset();

    stack.print();

    stack.push(5);
    stack.push(3);
    stack.push(8);
    stack.print();

    stack.pop();
    stack.print();

    stack.pop();
    stack.pop();

    stack.print();

    return 0;
}
</code></pre>

<p>This should print:</p>
<pre><code>( )
( 5 3 8 )
( 5 3 )
( )
</code></pre>

<p>答案：</p>
<pre><code>#include &lt;iostream&gt;
#include &lt;cassert&gt;

class Stack
{
private:
    static const int s_maxStackLength{ 10 };
    int m_array[s_maxStackLength]; // Here's where we're going to store our stack data
    int m_next; // This will hold the index of the next free element on the stack

public:

    void reset()
    {
        m_next = 0;
        for (int i = 0; i &lt; s_maxStackLength; ++i)
            m_array[i] = 0;
    }

    bool push(int value)
    {
        // If the stack is already full, return false and bail
        if (m_next == s_maxStackLength)
            return false;

        m_array[m_next++] = value; // set the next free element to the value, then increase m_next
        return true;
    }

    int pop()
    {
        // If there are no elements on the stack, assert out
        assert (m_next &gt; 0 &amp;&amp; &quot;Can not pop empty stack&quot;);

                // m_next points to the next free element, so the last valid element is m_next -1.
                // what we want to do is something like this:
                // int val = m_array[m_next-1]; // get the last valid element
                // --m_next; // m_next is now one less since we just removed the top element
                // return val; // return the element
                // that can be condensed down into this:
        return m_array[--m_next];
    }

    void print()
    {
        std::cout &lt;&lt; &quot;( &quot;;
        for (int i = 0; i &lt; m_next; ++i)
            std::cout &lt;&lt; m_array[i] &lt;&lt; ' ';
        std::cout &lt;&lt; &quot;)\n&quot;;
    }
};

int main()
{
    Stack stack;
    stack.reset();

    stack.print();

    stack.push(5);
    stack.push(3);
    stack.push(8);
    stack.print();

    stack.pop();
    stack.print();

    stack.pop();
    stack.pop();

    stack.print();

    return 0;
}
</code></pre></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>翻译（罗传月武）原文（Alex）</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
